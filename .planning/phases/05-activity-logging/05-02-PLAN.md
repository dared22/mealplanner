---
phase: 05-activity-logging
plan: 02
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - Backend/fastapi_app/main.py
autonomous: true
must_haves:
  truths:
    - "Admin can request paginated activity logs filtered by date range, actor type, and status."
    - "Activity log entries include timestamp, action description, actor identifier, and status."
  artifacts:
    - path: "Backend/fastapi_app/main.py"
      provides: "Admin activity log API"
      contains: "/admin/logs"
  key_links:
    - from: "Backend/fastapi_app/main.py"
      to: "ActivityLog"
      via: "select(ActivityLog)"
      pattern: "select\\(ActivityLog"
---

<objective>
Expose activity logs to administrators via a filtered, paginated API.

Purpose: Provide a stable backend contract for the admin Activity Logs screen.
Output: GET /admin/logs endpoint with filters and pagination.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@Backend/fastapi_app/main.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add activity log response models</name>
  <files>Backend/fastapi_app/main.py</files>
  <action>
Create Pydantic models for activity log rows and list response, mirroring AdminPagination patterns. Include id, created_at, actor_type, actor_id, actor_label, action_type, action_detail, status, and metadata fields.
  </action>
  <verify>python -m compileall Backend/fastapi_app</verify>
  <done>Pydantic models exist for activity log list responses and align with ActivityLog fields.</done>
</task>

<task type="auto">
  <name>Task 2: Implement GET /admin/logs with filters</name>
  <files>Backend/fastapi_app/main.py</files>
  <action>
Add a GET /admin/logs endpoint protected by admin_user_dependency. Support filters: start_date, end_date (UTC), actor_type (admin/user/system), status (success/warning/error/critical), plus limit/offset pagination. Order by created_at desc. Return items and pagination in the AdminPagination format.
  </action>
  <verify>python -m compileall Backend/fastapi_app</verify>
  <done>Admin logs endpoint returns paginated entries and respects date/type/status filters.</done>
</task>

</tasks>

<verification>
Admin logs API returns activity rows with pagination and filter controls.
</verification>

<success_criteria>
Backend exposes a stable /admin/logs contract ready for the admin UI.
</success_criteria>

<output>
After completion, create `.planning/phases/05-activity-logging/05-02-SUMMARY.md`
</output>
